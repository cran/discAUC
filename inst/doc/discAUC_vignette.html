<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Jonathan E. Friedel" />


<title>Using the discAUC package</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Using the discAUC package</h1>
<h4 class="author">Jonathan E. Friedel</h4>
<h4 class="date">2024 October, 10</h4>



<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>The <code>discAUC</code> package was written to be a generic method
to calculate various forms of area under the curve (AUC) for discounting
data. The original formulation of AUC for discounting data was <a href="https://doi.org/10.1901/jeab.2001.76-235">Myerson et
al. (2001)</a> and the formulations for AUClog and AUCord are described
in <a href="https://doi.org/10.1002/jeab.219">Borges et al. (2016)</a>.
The point of this package is not to provide <em>a better way</em> to
calculate AUC, rather it is to standardize the calculations. The goals
of this package are to:</p>
<ol style="list-style-type: decimal">
<li><p>Have a single function (<code>AUC</code>) to calculate
AUC.</p></li>
<li><p>Have a function to easily convert probability discounting for
<code>AUC</code>.</p>
<ul>
<li>As is the standard practice, AUC for probability discounting
requires converting the likelihood of receiving the outcome to the odds
against receiving the outcome.</li>
</ul></li>
<li><p>Have a function to easily prepare discounting data to calculate
AUCord.</p></li>
<li><p>Have a function to easily prepare discounting data to calculate
AUClog.</p></li>
<li><p>Have a function that will impute missing indifference points when
delay/social distance/odds against receiving the outcome/etc. are equal
to zero.</p></li>
</ol>
</div>
<div id="loading-the-package-and-setting-up-data" class="section level1">
<h1>Loading the Package and Setting up Data</h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="co">#Load discounting AUC package</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(discAUC)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="co">#Load dplyr, which aids in data manipulation</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code></pre></div>
<p>The one major assumption of this package is that discounting data are
<strong>Tidy</strong>. The principles of tidy data are outlined by <a href="https://doi.org/10.18637/jss.v059.i10">Wickham (2014)</a>. To
overly simplify, the discounting data should be organized in a
long-format in which there is only one indifference point per row of
data. All of the pertinent information for that indifference point
(e.g., subject/participant identifier, condition, delay, etc.) should be
organized in different columns of the data. Two example data sets are
included with the package that demonstrate the expected data format and
can be used to test the package.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co">#Example Tidy Delay Discounting Data</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>examp_DD</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="co">#&gt; # A tibble: 360 × 4</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="co">#&gt;    subject delay_months outcome       prop_indiff</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="co">#&gt;      &lt;dbl&gt;        &lt;dbl&gt; &lt;chr&gt;               &lt;dbl&gt;</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="co">#&gt;  1     103       0.0333 alcohol             0.878</span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="co">#&gt;  2     103       0.25   alcohol             0.749</span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="co">#&gt;  3     103       0.5    alcohol             0.747</span></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a><span class="co">#&gt;  4     103       1      alcohol             0.741</span></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a><span class="co">#&gt;  5     103       6      alcohol             0.249</span></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a><span class="co">#&gt;  6     103      60      alcohol             0.241</span></span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a><span class="co">#&gt;  7     103       0.0333 entertainment       0.987</span></span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a><span class="co">#&gt;  8     103       0.25   entertainment       0.933</span></span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a><span class="co">#&gt;  9     103       0.5    entertainment       0.929</span></span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a><span class="co">#&gt; 10     103       1      entertainment       0.935</span></span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a><span class="co">#&gt; # ℹ 350 more rows</span></span></code></pre></div>
<p>The indifference points are the last column in this example data set
(“prop_indiff”). For each indifference point the subject number, delay
to receiving the indifference point, and the type of outcome being
discounted are all labeled in different columns. The tidy format allows
for easier data manipulation and organization. For example, if you only
wanted to calculate AUC for a specific subject or for a specific set of
conditions then you filter the data based on the variables of
interest.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co">#Filter example DD data by subject (relies on dplyr library)</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>examp_DD <span class="sc">%&gt;%</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>  <span class="fu">filter</span>(subject <span class="sc">==</span> <span class="dv">103</span>)</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="co">#&gt; # A tibble: 24 × 4</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="co">#&gt;    subject delay_months outcome       prop_indiff</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="co">#&gt;      &lt;dbl&gt;        &lt;dbl&gt; &lt;chr&gt;               &lt;dbl&gt;</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="co">#&gt;  1     103       0.0333 alcohol             0.878</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="co">#&gt;  2     103       0.25   alcohol             0.749</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="co">#&gt;  3     103       0.5    alcohol             0.747</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="co">#&gt;  4     103       1      alcohol             0.741</span></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a><span class="co">#&gt;  5     103       6      alcohol             0.249</span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a><span class="co">#&gt;  6     103      60      alcohol             0.241</span></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a><span class="co">#&gt;  7     103       0.0333 entertainment       0.987</span></span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a><span class="co">#&gt;  8     103       0.25   entertainment       0.933</span></span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a><span class="co">#&gt;  9     103       0.5    entertainment       0.929</span></span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a><span class="co">#&gt; 10     103       1      entertainment       0.935</span></span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a><span class="co">#&gt; # ℹ 14 more rows</span></span>
<span id="cb3-18"><a href="#cb3-18" tabindex="-1"></a></span>
<span id="cb3-19"><a href="#cb3-19" tabindex="-1"></a><span class="co">#Filter example DD data by outcome type</span></span>
<span id="cb3-20"><a href="#cb3-20" tabindex="-1"></a>examp_DD <span class="sc">%&gt;%</span></span>
<span id="cb3-21"><a href="#cb3-21" tabindex="-1"></a>  <span class="fu">filter</span>(outcome<span class="sc">==</span><span class="st">&quot;alcohol&quot;</span>)</span>
<span id="cb3-22"><a href="#cb3-22" tabindex="-1"></a><span class="co">#&gt; # A tibble: 90 × 4</span></span>
<span id="cb3-23"><a href="#cb3-23" tabindex="-1"></a><span class="co">#&gt;    subject delay_months outcome prop_indiff</span></span>
<span id="cb3-24"><a href="#cb3-24" tabindex="-1"></a><span class="co">#&gt;      &lt;dbl&gt;        &lt;dbl&gt; &lt;chr&gt;         &lt;dbl&gt;</span></span>
<span id="cb3-25"><a href="#cb3-25" tabindex="-1"></a><span class="co">#&gt;  1     103       0.0333 alcohol       0.878</span></span>
<span id="cb3-26"><a href="#cb3-26" tabindex="-1"></a><span class="co">#&gt;  2     103       0.25   alcohol       0.749</span></span>
<span id="cb3-27"><a href="#cb3-27" tabindex="-1"></a><span class="co">#&gt;  3     103       0.5    alcohol       0.747</span></span>
<span id="cb3-28"><a href="#cb3-28" tabindex="-1"></a><span class="co">#&gt;  4     103       1      alcohol       0.741</span></span>
<span id="cb3-29"><a href="#cb3-29" tabindex="-1"></a><span class="co">#&gt;  5     103       6      alcohol       0.249</span></span>
<span id="cb3-30"><a href="#cb3-30" tabindex="-1"></a><span class="co">#&gt;  6     103      60      alcohol       0.241</span></span>
<span id="cb3-31"><a href="#cb3-31" tabindex="-1"></a><span class="co">#&gt;  7     108       0.0333 alcohol       0.298</span></span>
<span id="cb3-32"><a href="#cb3-32" tabindex="-1"></a><span class="co">#&gt;  8     108       0.25   alcohol       0.298</span></span>
<span id="cb3-33"><a href="#cb3-33" tabindex="-1"></a><span class="co">#&gt;  9     108       0.5    alcohol       0.298</span></span>
<span id="cb3-34"><a href="#cb3-34" tabindex="-1"></a><span class="co">#&gt; 10     108       1      alcohol       0.298</span></span>
<span id="cb3-35"><a href="#cb3-35" tabindex="-1"></a><span class="co">#&gt; # ℹ 80 more rows</span></span></code></pre></div>
</div>
<div id="calculating-auc" class="section level1">
<h1>Calculating AUC</h1>
<p>For the initial demonstrations, we will use the median indifference
points for money to show the calculations for AUC. We will obtain the
median indifference points for both delay discounting (DD) and
probability discounting (PD).</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co">#Subject -987.987 are precalculated median indifference points for each outcome.</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>DD_med_indiff <span class="ot">=</span> examp_DD <span class="sc">%&gt;%</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>                <span class="fu">filter</span>(subject <span class="sc">==</span> <span class="sc">-</span><span class="fl">987.987</span>,</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>                outcome <span class="sc">==</span> <span class="st">&quot;$100 Gain&quot;</span>)</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>PD_med_indiff <span class="ot">=</span> examp_PD <span class="sc">%&gt;%</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>                <span class="fu">filter</span>(subject <span class="sc">==</span> <span class="sc">-</span><span class="fl">987.987</span>,</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>                outcome <span class="sc">==</span> <span class="st">&quot;$100 Gain&quot;</span>)</span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="co">#Note that the median indifference point subject number (-987.987) is truncated in the output.</span></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a>DD_med_indiff</span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 4</span></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a><span class="co">#&gt;   subject delay_months outcome   prop_indiff</span></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a><span class="co">#&gt;     &lt;dbl&gt;        &lt;dbl&gt; &lt;chr&gt;           &lt;dbl&gt;</span></span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a><span class="co">#&gt; 1   -988.       0.0333 $100 Gain       0.957</span></span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a><span class="co">#&gt; 2   -988.       0.25   $100 Gain       0.862</span></span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a><span class="co">#&gt; 3   -988.       0.5    $100 Gain       0.771</span></span>
<span id="cb4-18"><a href="#cb4-18" tabindex="-1"></a><span class="co">#&gt; 4   -988.       1      $100 Gain       0.750</span></span>
<span id="cb4-19"><a href="#cb4-19" tabindex="-1"></a><span class="co">#&gt; 5   -988.       6      $100 Gain       0.456</span></span>
<span id="cb4-20"><a href="#cb4-20" tabindex="-1"></a><span class="co">#&gt; 6   -988.      60      $100 Gain       0.200</span></span>
<span id="cb4-21"><a href="#cb4-21" tabindex="-1"></a></span>
<span id="cb4-22"><a href="#cb4-22" tabindex="-1"></a>PD_med_indiff</span>
<span id="cb4-23"><a href="#cb4-23" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 4</span></span>
<span id="cb4-24"><a href="#cb4-24" tabindex="-1"></a><span class="co">#&gt;   subject  prob outcome   prop_indiff</span></span>
<span id="cb4-25"><a href="#cb4-25" tabindex="-1"></a><span class="co">#&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;           &lt;dbl&gt;</span></span>
<span id="cb4-26"><a href="#cb4-26" tabindex="-1"></a><span class="co">#&gt; 1   -988.  0.95 $100 Gain       0.957</span></span>
<span id="cb4-27"><a href="#cb4-27" tabindex="-1"></a><span class="co">#&gt; 2   -988.  0.9  $100 Gain       0.862</span></span>
<span id="cb4-28"><a href="#cb4-28" tabindex="-1"></a><span class="co">#&gt; 3   -988.  0.7  $100 Gain       0.771</span></span>
<span id="cb4-29"><a href="#cb4-29" tabindex="-1"></a><span class="co">#&gt; 4   -988.  0.5  $100 Gain       0.750</span></span>
<span id="cb4-30"><a href="#cb4-30" tabindex="-1"></a><span class="co">#&gt; 5   -988.  0.3  $100 Gain       0.456</span></span>
<span id="cb4-31"><a href="#cb4-31" tabindex="-1"></a><span class="co">#&gt; 6   -988.  0.05 $100 Gain       0.200</span></span></code></pre></div>
<p>If the data are in a tidy format, AUC can be calculated simply by
supplying the data to the <code>AUC</code> function and entering the
necessary parameters. Several parts of the function are looking for the
variable names in the data that indicate the relevant data. The variable
names should be entered within quotes (<code>&quot;prop_indiff&quot;</code>
instead of <code>prop_indiff</code>). The <code>x_axis</code> is the
delay/social distance/likelihood of receiving the outcome. The
<code>amount</code> must be set manually because it is possible that an
indifference point with the maximum value (amount of the larger outcome)
does not exist in the data. The <code>grouping</code> factor is designed
to aid in calculating AUC across a whole data set at once (see below).
At this time a <code>grouping</code> factor must be included, even if
there is only <em>one</em> set of indifference points being used to
calculate AUC.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">AUC</span>(<span class="at">dat =</span> DD_med_indiff,</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>    <span class="at">indiff =</span> <span class="st">&quot;prop_indiff&quot;</span>,</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>    <span class="at">x_axis =</span> <span class="st">&quot;delay_months&quot;</span>,</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>    <span class="at">amount =</span> <span class="dv">1</span>,</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>    <span class="at">grouping =</span> <span class="st">&quot;subject&quot;</span>)</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="co">#&gt; # A tibble: 1 × 2</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="co">#&gt;   subject   AUC</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="co">#&gt;     &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="co">#&gt; 1   -988. 0.359</span></span></code></pre></div>
<p>To calculate probability discounting, set the flag of
<code>prob_disc = TRUE.</code> The function will convert all of the
likelihoods (<code>prob</code>) to odds against receiving the outcome.
AUC will then be calculated based on the odds against receiving the
outcome. Note, that the output will not clearly indicate that you
calculated AUC for probability discounting data because the function
only returns AUC values.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">AUC</span>(<span class="at">dat =</span> PD_med_indiff,</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>    <span class="at">indiff =</span> <span class="st">&quot;prop_indiff&quot;</span>,</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>    <span class="at">x_axis =</span> <span class="st">&quot;prob&quot;</span>,</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>    <span class="at">amount =</span> <span class="dv">1</span>,</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>    <span class="at">grouping =</span> <span class="st">&quot;subject&quot;</span>,</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>    <span class="at">prob_disc =</span> <span class="cn">TRUE</span>)</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a><span class="co">#&gt; # A tibble: 1 × 2</span></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a><span class="co">#&gt;   subject   AUC</span></span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a><span class="co">#&gt;     &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a><span class="co">#&gt; 1   -988. 0.372</span></span></code></pre></div>
<div id="different-versions-of-auc" class="section level2">
<h2>Different Versions of AUC</h2>
<p><a href="https://doi.org/10.1002/jeab.219">Borges et al. (2016)</a>
outlined two alternative methods for calculating AUC. AUClog simply
transforms the <code>x_axis</code> values and calculates AUC based on
the transformed values. AUCord transforms the <code>x_axis</code> values
into their ordinal position and calculates AUC based on the ordinal
position.</p>
<div id="calculating-aucord" class="section level3">
<h3>Calculating AUC<em>ord</em></h3>
<p>We will describe calculating AUCord first because it can be done
simply by changing the type of AUC in the function. Specifically,
<code>type = &quot;ordinal&quot;</code></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co">#Ordinal AUC for DD data</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="fu">AUC</span>(<span class="at">dat =</span> DD_med_indiff,</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>    <span class="at">indiff =</span> <span class="st">&quot;prop_indiff&quot;</span>,</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>    <span class="at">x_axis =</span> <span class="st">&quot;delay_months&quot;</span>,</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>    <span class="at">amount =</span> <span class="dv">1</span>,</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>    <span class="at">grouping =</span> <span class="st">&quot;subject&quot;</span>,</span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">&quot;ordinal&quot;</span>)</span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="co">#&gt; # A tibble: 1 × 2</span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a><span class="co">#&gt;   subject   AUC</span></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a><span class="co">#&gt;     &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a><span class="co">#&gt; 1   -988. 0.359</span></span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a></span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a><span class="co">#Ordinal AUC for PD data</span></span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a><span class="fu">AUC</span>(<span class="at">dat =</span> PD_med_indiff,</span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a>    <span class="at">indiff =</span> <span class="st">&quot;prop_indiff&quot;</span>,</span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a>    <span class="at">x_axis =</span> <span class="st">&quot;prob&quot;</span>,</span>
<span id="cb7-17"><a href="#cb7-17" tabindex="-1"></a>    <span class="at">amount =</span> <span class="dv">1</span>,</span>
<span id="cb7-18"><a href="#cb7-18" tabindex="-1"></a>    <span class="at">groupings =</span> <span class="st">&quot;subject&quot;</span>,</span>
<span id="cb7-19"><a href="#cb7-19" tabindex="-1"></a>    <span class="at">prob_disc =</span> <span class="cn">TRUE</span>,</span>
<span id="cb7-20"><a href="#cb7-20" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">&quot;ordinal&quot;</span>)</span>
<span id="cb7-21"><a href="#cb7-21" tabindex="-1"></a><span class="co">#&gt; # A tibble: 1 × 2</span></span>
<span id="cb7-22"><a href="#cb7-22" tabindex="-1"></a><span class="co">#&gt;   subject   AUC</span></span>
<span id="cb7-23"><a href="#cb7-23" tabindex="-1"></a><span class="co">#&gt;     &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb7-24"><a href="#cb7-24" tabindex="-1"></a><span class="co">#&gt; 1   -988. 0.372</span></span></code></pre></div>
<p><em>Note on the order of operations</em>: When calculating AUCord for
probability discounting data, the AUC function will obtain the odds
against and then calculate the ordinal values based on the odds
against.</p>
</div>
<div id="calculating-auclog" class="section level3">
<h3>Calculating AUC<em>log</em></h3>
<p>Calculating AUClog with the AUC function is also relatively simple.
However, in addition to setting the <code>type = &quot;log&quot;</code> you can
also specify the base of the logarithm you wish to use. By default, the
function uses a base of 2. The AUC function uses an adjustment procedure
(based on the average distance between log transformed values) to
account for when the x_axis value equals 0. See below for a full
description of the correction types.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="co">#Ordinal AUC for DD data</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="fu">AUC</span>(<span class="at">dat =</span> DD_med_indiff,</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>    <span class="at">indiff =</span> <span class="st">&quot;prop_indiff&quot;</span>,</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>    <span class="at">x_axis =</span> <span class="st">&quot;delay_months&quot;</span>,</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>    <span class="at">amount =</span> <span class="dv">1</span>,</span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>    <span class="at">grouping =</span> <span class="st">&quot;subject&quot;</span>,</span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">&quot;log&quot;</span>)</span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a><span class="co">#&gt; # A tibble: 1 × 2</span></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a><span class="co">#&gt;   subject   AUC</span></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a><span class="co">#&gt;     &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a><span class="co">#&gt; 1   -988. 0.693</span></span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a></span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a><span class="co">#Ordinal AUC for PD data with log base 10</span></span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a><span class="fu">AUC</span>(<span class="at">dat =</span> PD_med_indiff,</span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a>    <span class="at">indiff =</span> <span class="st">&quot;prop_indiff&quot;</span>,</span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a>    <span class="at">x_axis =</span> <span class="st">&quot;prob&quot;</span>,</span>
<span id="cb8-17"><a href="#cb8-17" tabindex="-1"></a>    <span class="at">amount =</span> <span class="dv">1</span>,</span>
<span id="cb8-18"><a href="#cb8-18" tabindex="-1"></a>    <span class="at">groupings =</span> <span class="st">&quot;subject&quot;</span>,</span>
<span id="cb8-19"><a href="#cb8-19" tabindex="-1"></a>    <span class="at">prob_disc =</span> <span class="cn">TRUE</span>,</span>
<span id="cb8-20"><a href="#cb8-20" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">&quot;log&quot;</span>,</span>
<span id="cb8-21"><a href="#cb8-21" tabindex="-1"></a>    <span class="at">log_base =</span> <span class="dv">10</span>)</span>
<span id="cb8-22"><a href="#cb8-22" tabindex="-1"></a><span class="co">#&gt; # A tibble: 1 × 2</span></span>
<span id="cb8-23"><a href="#cb8-23" tabindex="-1"></a><span class="co">#&gt;   subject   AUC</span></span>
<span id="cb8-24"><a href="#cb8-24" tabindex="-1"></a><span class="co">#&gt;     &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb8-25"><a href="#cb8-25" tabindex="-1"></a><span class="co">#&gt; 1   -988. 0.676</span></span></code></pre></div>
</div>
</div>
<div id="calculating-auc-for-larger-data-sets" class="section level2">
<h2>Calculating AUC for larger data sets</h2>
<p>A single data set might have several sets of indifference points. The
example data sets include indifference one set of indifference points
per outcome for each participant. Instead of calculating AUC one-by-one
for each specific set, AUC can be calculated <em>en masse</em> for all
of the sets of indifference points. To use the <em>en masse</em> AUC
calculations, you need to set the variables that can be used to identify
each specific set of indifference points in the <code>groupings</code>
factor. The column names should be entered within quotes.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co">#For demonstration, filter for median indifference points for all outcomes.</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>DD_med_outcomes <span class="ot">=</span> examp_DD <span class="sc">%&gt;%</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>              <span class="fu">filter</span>(subject <span class="sc">==</span> <span class="sc">-</span><span class="fl">987.987</span>)</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="co">#Simple AUC</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="fu">AUC</span>(<span class="at">dat =</span> DD_med_outcomes,</span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a>    <span class="at">indiff =</span> <span class="st">&quot;prop_indiff&quot;</span>,</span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a>    <span class="at">x_axis =</span> <span class="st">&quot;delay_months&quot;</span>,</span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a>    <span class="at">amount =</span> <span class="dv">1</span>,</span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a>    <span class="at">grouping =</span> <span class="st">&quot;outcome&quot;</span>)</span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a><span class="co">#&gt; # A tibble: 4 × 2</span></span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a><span class="co">#&gt;   outcome          AUC</span></span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;          &lt;dbl&gt;</span></span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a><span class="co">#&gt; 1 $100 Gain     0.359 </span></span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a><span class="co">#&gt; 2 alcohol       0.0953</span></span>
<span id="cb9-16"><a href="#cb9-16" tabindex="-1"></a><span class="co">#&gt; 3 entertainment 0.405 </span></span>
<span id="cb9-17"><a href="#cb9-17" tabindex="-1"></a><span class="co">#&gt; 4 food          0.158</span></span></code></pre></div>
<p>For this example, we simplified the example data to the median
indifference points for each outcome. We added
<code>grouping = &quot;outcome&quot;</code> to indicate that the function should
return an AUC value for each outcome in the median indifference point
data set. The <code>AUC</code> returns a different AUC value for each
level in the “grouping” factor.</p>
<p>The grouping function can handle more than one variable at a time by
using the combine function <code>c()</code> on the left hand side of the
<code>grouping =</code> in the <code>AUC</code> function. The columns
that should be used to identify the independent the sets of indifference
points should be entered as
<code>c(&quot;variable1&quot;, &quot;variable2&quot;, &quot;variable3&quot;, etc.)</code>. In the
following example, AUC is calculated for each outcome by subject.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="co">#AUC by outcome and subject</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="fu">AUC</span>(<span class="at">dat =</span> examp_DD,</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>    <span class="at">indiff =</span> <span class="st">&quot;prop_indiff&quot;</span>,</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>    <span class="at">x_axis =</span> <span class="st">&quot;delay_months&quot;</span>,</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>    <span class="at">amount =</span> <span class="dv">1</span>,</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>    <span class="at">grouping =</span> <span class="fu">c</span>(<span class="st">&quot;outcome&quot;</span>, <span class="st">&quot;subject&quot;</span>))</span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a><span class="co">#&gt; # A tibble: 60 × 3</span></span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a><span class="co">#&gt; # Groups:   outcome [4]</span></span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a><span class="co">#&gt;    outcome   subject      AUC</span></span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a><span class="co">#&gt;    &lt;chr&gt;       &lt;dbl&gt;    &lt;dbl&gt;</span></span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a><span class="co">#&gt;  1 $100 Gain   -988. 0.359   </span></span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a><span class="co">#&gt;  2 $100 Gain     -2  0.000278</span></span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a><span class="co">#&gt;  3 $100 Gain     -1  1       </span></span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a><span class="co">#&gt;  4 $100 Gain    103  0.789   </span></span>
<span id="cb10-15"><a href="#cb10-15" tabindex="-1"></a><span class="co">#&gt;  5 $100 Gain    108  0.768   </span></span>
<span id="cb10-16"><a href="#cb10-16" tabindex="-1"></a><span class="co">#&gt;  6 $100 Gain    119  0.669   </span></span>
<span id="cb10-17"><a href="#cb10-17" tabindex="-1"></a><span class="co">#&gt;  7 $100 Gain    122  0.462   </span></span>
<span id="cb10-18"><a href="#cb10-18" tabindex="-1"></a><span class="co">#&gt;  8 $100 Gain    142  0.0642  </span></span>
<span id="cb10-19"><a href="#cb10-19" tabindex="-1"></a><span class="co">#&gt;  9 $100 Gain    169  0.0673  </span></span>
<span id="cb10-20"><a href="#cb10-20" tabindex="-1"></a><span class="co">#&gt; 10 $100 Gain    175  0.465   </span></span>
<span id="cb10-21"><a href="#cb10-21" tabindex="-1"></a><span class="co">#&gt; # ℹ 50 more rows</span></span></code></pre></div>
<p>The order of the <code>grouping</code> variable does not change the
resulting AUC data, only the order in which the columns are
returned.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="co">#AUC by outcome and subject</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="fu">AUC</span>(<span class="at">dat =</span> examp_DD,</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>    <span class="at">indiff =</span> <span class="st">&quot;prop_indiff&quot;</span>,</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>    <span class="at">x_axis =</span> <span class="st">&quot;delay_months&quot;</span>,</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>    <span class="at">amount =</span> <span class="dv">1</span>,</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>    <span class="at">grouping =</span> <span class="fu">c</span>(<span class="st">&quot;outcome&quot;</span>, <span class="st">&quot;subject&quot;</span>))</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a><span class="co">#&gt; # A tibble: 60 × 3</span></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a><span class="co">#&gt; # Groups:   outcome [4]</span></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a><span class="co">#&gt;    outcome   subject      AUC</span></span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a><span class="co">#&gt;    &lt;chr&gt;       &lt;dbl&gt;    &lt;dbl&gt;</span></span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a><span class="co">#&gt;  1 $100 Gain   -988. 0.359   </span></span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a><span class="co">#&gt;  2 $100 Gain     -2  0.000278</span></span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a><span class="co">#&gt;  3 $100 Gain     -1  1       </span></span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a><span class="co">#&gt;  4 $100 Gain    103  0.789   </span></span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a><span class="co">#&gt;  5 $100 Gain    108  0.768   </span></span>
<span id="cb11-16"><a href="#cb11-16" tabindex="-1"></a><span class="co">#&gt;  6 $100 Gain    119  0.669   </span></span>
<span id="cb11-17"><a href="#cb11-17" tabindex="-1"></a><span class="co">#&gt;  7 $100 Gain    122  0.462   </span></span>
<span id="cb11-18"><a href="#cb11-18" tabindex="-1"></a><span class="co">#&gt;  8 $100 Gain    142  0.0642  </span></span>
<span id="cb11-19"><a href="#cb11-19" tabindex="-1"></a><span class="co">#&gt;  9 $100 Gain    169  0.0673  </span></span>
<span id="cb11-20"><a href="#cb11-20" tabindex="-1"></a><span class="co">#&gt; 10 $100 Gain    175  0.465   </span></span>
<span id="cb11-21"><a href="#cb11-21" tabindex="-1"></a><span class="co">#&gt; # ℹ 50 more rows</span></span>
<span id="cb11-22"><a href="#cb11-22" tabindex="-1"></a></span>
<span id="cb11-23"><a href="#cb11-23" tabindex="-1"></a><span class="co">#AUC by subject and outcome</span></span>
<span id="cb11-24"><a href="#cb11-24" tabindex="-1"></a><span class="fu">AUC</span>(<span class="at">dat =</span> examp_DD,</span>
<span id="cb11-25"><a href="#cb11-25" tabindex="-1"></a>    <span class="at">indiff =</span> <span class="st">&quot;prop_indiff&quot;</span>,</span>
<span id="cb11-26"><a href="#cb11-26" tabindex="-1"></a>    <span class="at">x_axis =</span> <span class="st">&quot;delay_months&quot;</span>,</span>
<span id="cb11-27"><a href="#cb11-27" tabindex="-1"></a>    <span class="at">amount =</span> <span class="dv">1</span>,</span>
<span id="cb11-28"><a href="#cb11-28" tabindex="-1"></a>    <span class="at">grouping =</span> <span class="fu">c</span>(<span class="st">&quot;subject&quot;</span>, <span class="st">&quot;outcome&quot;</span>))</span>
<span id="cb11-29"><a href="#cb11-29" tabindex="-1"></a><span class="co">#&gt; # A tibble: 60 × 3</span></span>
<span id="cb11-30"><a href="#cb11-30" tabindex="-1"></a><span class="co">#&gt; # Groups:   subject [15]</span></span>
<span id="cb11-31"><a href="#cb11-31" tabindex="-1"></a><span class="co">#&gt;    subject outcome            AUC</span></span>
<span id="cb11-32"><a href="#cb11-32" tabindex="-1"></a><span class="co">#&gt;      &lt;dbl&gt; &lt;chr&gt;            &lt;dbl&gt;</span></span>
<span id="cb11-33"><a href="#cb11-33" tabindex="-1"></a><span class="co">#&gt;  1   -988. $100 Gain     0.359   </span></span>
<span id="cb11-34"><a href="#cb11-34" tabindex="-1"></a><span class="co">#&gt;  2   -988. alcohol       0.0953  </span></span>
<span id="cb11-35"><a href="#cb11-35" tabindex="-1"></a><span class="co">#&gt;  3   -988. entertainment 0.405   </span></span>
<span id="cb11-36"><a href="#cb11-36" tabindex="-1"></a><span class="co">#&gt;  4   -988. food          0.158   </span></span>
<span id="cb11-37"><a href="#cb11-37" tabindex="-1"></a><span class="co">#&gt;  5     -2  $100 Gain     0.000278</span></span>
<span id="cb11-38"><a href="#cb11-38" tabindex="-1"></a><span class="co">#&gt;  6     -2  alcohol       0.000278</span></span>
<span id="cb11-39"><a href="#cb11-39" tabindex="-1"></a><span class="co">#&gt;  7     -2  entertainment 0.000278</span></span>
<span id="cb11-40"><a href="#cb11-40" tabindex="-1"></a><span class="co">#&gt;  8     -2  food          0.000278</span></span>
<span id="cb11-41"><a href="#cb11-41" tabindex="-1"></a><span class="co">#&gt;  9     -1  $100 Gain     1       </span></span>
<span id="cb11-42"><a href="#cb11-42" tabindex="-1"></a><span class="co">#&gt; 10     -1  alcohol       1       </span></span>
<span id="cb11-43"><a href="#cb11-43" tabindex="-1"></a><span class="co">#&gt; # ℹ 50 more rows</span></span></code></pre></div>
</div>
</div>
<div id="finer-control-of-auc-calculations" class="section level1">
<h1>Finer Control of AUC calculations</h1>
<p>If you are calculating probability discounting, AUClog, or AUCord,
technically the <code>AUC()</code> function does not transform you
<code>x_axis</code> values. The AUC only uses the default AUC equation
as described by <a href="https://doi.org/10.1901/jeab.2001.76-235">Myerson et
al. (2001)</a>. That is AUC is the sum of all the trapezoid area between
successive indifference points. A single trapezoid has an area of,</p>
<p><span class="math display">\[
(x_2 -x_1)*\frac{y_1+y_2}{2}
\]</span></p>
<p>where the <em>x</em> values are the successive delays, social
distances, odds against, etc. and the <em>y</em> values are the
successive indifference points. The <em>x</em> values are all
standardized by the maximum delay, social distance, odds against, etc.
The <em>y</em> values are all standardized by the amount of the larger
outcome.</p>
<p>Within the <code>discAUC</code> package are separate functions that
calculate the transformations on the indifference points supplied to the
<code>AUC()</code> function. The <code>AUC()</code> function calls those
specific transformation functions and then uses the transformed data in
the above formula. In other words, there are no special versions of the
above formula like,</p>
<p><span class="math display">\[
[log(x_2) -log(x_1)]*\frac{y_1+y_2}{2}
\]</span></p>
<p>rather, each transformation is conducted and then fed back into the
original formulation of AUC.</p>
<p>Each of the specific transformation functions can be called on their
own. Using the functions prior to the AUC function is useful if you
would like fine control of all of the pieces of the AUC calculation or
you would like to inspect the transformed data prior to the AUC
calculation.</p>
<div id="auc_zeros" class="section level2">
<h2>AUC_zeros()</h2>
<p><a href="https://doi.org/10.1901/jeab.2001.76-235">Myerson et
al. (2001)</a> call for including an indifference point when the x_axis
value = 0. If an experimental assessment of the indifference point at X
= 0 was not obtained then the value should be added. If the indifference
points need to be added, the value of each added indifference should be
equal to the larger outcome (i.e., <em>A</em> from a discounting
model<em>)</em>.</p>
<p>The <code>AUC_zeros</code> function will add zeros to a tidy set of
indifference points. The function will only add the indifference points
at X = 0 if they did not already exist in the data. Additionally, a new
column will be added to the data file that will indicate which
indifference points were originally included and which indifference
points were added by the function.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="co">#Examp_DD data did not include indifference points when delay = 0</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="fu">AUC_zeros</span>(<span class="at">dat =</span> examp_DD,</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>          <span class="at">indiff =</span> <span class="st">&quot;prop_indiff&quot;</span>,</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>          <span class="at">x_axis =</span> <span class="st">&quot;delay_months&quot;</span>,</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>          <span class="at">amount =</span> <span class="dv">1</span>,</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>          <span class="at">groupings =</span> <span class="fu">c</span>(<span class="st">&quot;subject&quot;</span>,<span class="st">&quot;outcome&quot;</span>))</span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a><span class="co">#&gt; # A tibble: 420 × 5</span></span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a><span class="co">#&gt;    subject outcome       delay_months prop_indiff orig </span></span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a><span class="co">#&gt;      &lt;dbl&gt; &lt;chr&gt;                &lt;dbl&gt;       &lt;dbl&gt; &lt;lgl&gt;</span></span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a><span class="co">#&gt;  1     103 alcohol             0            1     FALSE</span></span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a><span class="co">#&gt;  2     103 alcohol             0.0333       0.878 TRUE </span></span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a><span class="co">#&gt;  3     103 alcohol             0.25         0.749 TRUE </span></span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a><span class="co">#&gt;  4     103 alcohol             0.5          0.747 TRUE </span></span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a><span class="co">#&gt;  5     103 alcohol             1            0.741 TRUE </span></span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a><span class="co">#&gt;  6     103 alcohol             6            0.249 TRUE </span></span>
<span id="cb12-16"><a href="#cb12-16" tabindex="-1"></a><span class="co">#&gt;  7     103 alcohol            60            0.241 TRUE </span></span>
<span id="cb12-17"><a href="#cb12-17" tabindex="-1"></a><span class="co">#&gt;  8     103 entertainment       0            1     FALSE</span></span>
<span id="cb12-18"><a href="#cb12-18" tabindex="-1"></a><span class="co">#&gt;  9     103 entertainment       0.0333       0.987 TRUE </span></span>
<span id="cb12-19"><a href="#cb12-19" tabindex="-1"></a><span class="co">#&gt; 10     103 entertainment       0.25         0.933 TRUE </span></span>
<span id="cb12-20"><a href="#cb12-20" tabindex="-1"></a><span class="co">#&gt; # ℹ 410 more rows</span></span></code></pre></div>
<p>With probability discounting, the odds against values will be in the
opposite order of the likelihoods of receiving the outcome. For that
reason, if the data are probability discounting data you must indicate
that <code>prob_disc = TRUE</code> in the function call. This will
impute an indifference point with a likelihood of occurring of 100%.
With a likelihood of 100% the odds against receiving that outcome will
be converted to 0.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="co">#Examp_PD data did not include indifference points when prob = 1</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="fu">AUC_zeros</span>(<span class="at">dat =</span> examp_PD,</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>          <span class="at">indiff =</span> <span class="st">&quot;prop_indiff&quot;</span>,</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>          <span class="at">x_axis =</span> <span class="st">&quot;prob&quot;</span>,</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>          <span class="at">amount =</span> <span class="dv">1</span>,</span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>          <span class="at">groupings =</span> <span class="fu">c</span>(<span class="st">&quot;subject&quot;</span>,<span class="st">&quot;outcome&quot;</span>),</span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a>          <span class="at">prob_disc =</span> <span class="cn">TRUE</span></span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a>          )</span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a><span class="co">#&gt; # A tibble: 420 × 5</span></span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a><span class="co">#&gt;    subject outcome        prob prop_indiff orig </span></span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a><span class="co">#&gt;      &lt;dbl&gt; &lt;chr&gt;         &lt;dbl&gt;       &lt;dbl&gt; &lt;lgl&gt;</span></span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a><span class="co">#&gt;  1     103 alcohol        1          1     FALSE</span></span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a><span class="co">#&gt;  2     103 alcohol        0.95       0.878 TRUE </span></span>
<span id="cb13-14"><a href="#cb13-14" tabindex="-1"></a><span class="co">#&gt;  3     103 alcohol        0.9        0.749 TRUE </span></span>
<span id="cb13-15"><a href="#cb13-15" tabindex="-1"></a><span class="co">#&gt;  4     103 alcohol        0.7        0.747 TRUE </span></span>
<span id="cb13-16"><a href="#cb13-16" tabindex="-1"></a><span class="co">#&gt;  5     103 alcohol        0.5        0.741 TRUE </span></span>
<span id="cb13-17"><a href="#cb13-17" tabindex="-1"></a><span class="co">#&gt;  6     103 alcohol        0.3        0.249 TRUE </span></span>
<span id="cb13-18"><a href="#cb13-18" tabindex="-1"></a><span class="co">#&gt;  7     103 alcohol        0.05       0.241 TRUE </span></span>
<span id="cb13-19"><a href="#cb13-19" tabindex="-1"></a><span class="co">#&gt;  8     103 entertainment  1          1     FALSE</span></span>
<span id="cb13-20"><a href="#cb13-20" tabindex="-1"></a><span class="co">#&gt;  9     103 entertainment  0.95       0.987 TRUE </span></span>
<span id="cb13-21"><a href="#cb13-21" tabindex="-1"></a><span class="co">#&gt; 10     103 entertainment  0.9        0.933 TRUE </span></span>
<span id="cb13-22"><a href="#cb13-22" tabindex="-1"></a><span class="co">#&gt; # ℹ 410 more rows</span></span></code></pre></div>
</div>
<div id="prep_odds_against" class="section level2">
<h2>prep_odds_against()</h2>
<p>With the <code>prep_odds_against()</code> function, you can indicate
the <code>x_axis</code> variable and the function will calculate the
odds against receiving the outcome. Odds against is the typical form for
displaying probability discounting because the value of the outcome will
decrease as the odds against receiving the outcome increase. The formula
for calculating the odds against is</p>
<p><span class="math display">\[
\frac{1-p}{p}
\]</span></p>
<p>where <em>p</em> is the probability of receiving the outcome.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="co">#Make sure to indicate groupings, if necessary</span></span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a><span class="fu">prep_odds_against</span>(<span class="at">dat =</span> examp_PD,</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>                  <span class="at">x_axis =</span> <span class="st">&quot;prob&quot;</span>,</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>                  <span class="at">groupings =</span> <span class="fu">c</span>(<span class="st">&quot;subject&quot;</span>,<span class="st">&quot;outcome&quot;</span>))</span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a><span class="co">#&gt; # A tibble: 360 × 5</span></span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a><span class="co">#&gt; # Groups:   subject, outcome [60]</span></span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a><span class="co">#&gt;    subject  prob outcome   prop_indiff prob_against</span></span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a><span class="co">#&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;           &lt;dbl&gt;        &lt;dbl&gt;</span></span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a><span class="co">#&gt;  1   -988.  0.95 $100 Gain       0.957       0.0526</span></span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a><span class="co">#&gt;  2   -988.  0.9  $100 Gain       0.862       0.111 </span></span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a><span class="co">#&gt;  3   -988.  0.7  $100 Gain       0.771       0.429 </span></span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a><span class="co">#&gt;  4   -988.  0.5  $100 Gain       0.750       1     </span></span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a><span class="co">#&gt;  5   -988.  0.3  $100 Gain       0.456       2.33  </span></span>
<span id="cb14-15"><a href="#cb14-15" tabindex="-1"></a><span class="co">#&gt;  6   -988.  0.05 $100 Gain       0.200      19     </span></span>
<span id="cb14-16"><a href="#cb14-16" tabindex="-1"></a><span class="co">#&gt;  7   -988.  0.95 alcohol         0.569       0.0526</span></span>
<span id="cb14-17"><a href="#cb14-17" tabindex="-1"></a><span class="co">#&gt;  8   -988.  0.9  alcohol         0.273       0.111 </span></span>
<span id="cb14-18"><a href="#cb14-18" tabindex="-1"></a><span class="co">#&gt;  9   -988.  0.7  alcohol         0.329       0.429 </span></span>
<span id="cb14-19"><a href="#cb14-19" tabindex="-1"></a><span class="co">#&gt; 10   -988.  0.5  alcohol         0.189       1     </span></span>
<span id="cb14-20"><a href="#cb14-20" tabindex="-1"></a><span class="co">#&gt; # ℹ 350 more rows</span></span></code></pre></div>
<p>The odds against will be added as a new variable in the data set. The
name of the variable will be the name of the original probability
variable (“prob” in this case) with “_against” added afterwards. For the
<code>examp_PD</code> data set, the odds against will be included as
<code>prob_against</code>. Indicating the indifference points in this
function is unnecessary, because it only transforms the probability of
receiving the outcomes.</p>
</div>
<div id="prep_ordinal" class="section level2">
<h2>prep_ordinal()</h2>
<p>The <code>prep_ordinal()</code> function behaves very similarly to
<code>prep_odds_against()</code>. <code>prep_ordinal()</code> transforms
the <code>x_axis</code> values into the ordinal position. Note that if
there are indifference points for when the x_axis = 0, the ordinal value
will be calculated as 0.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a><span class="co">#Groupings must be specified, if necessary</span></span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a><span class="fu">prep_ordinal</span>(<span class="at">dat =</span> examp_DD,</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>             <span class="at">x_axis =</span> <span class="st">&quot;delay_months&quot;</span>,</span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>             <span class="at">groupings =</span> <span class="fu">c</span>(<span class="st">&quot;subject&quot;</span>,<span class="st">&quot;outcome&quot;</span>))</span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a><span class="co">#&gt; # A tibble: 360 × 5</span></span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a><span class="co">#&gt; # Groups:   subject, outcome [60]</span></span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a><span class="co">#&gt;    subject delay_months outcome   prop_indiff delay_months_ord</span></span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a><span class="co">#&gt;      &lt;dbl&gt;        &lt;dbl&gt; &lt;chr&gt;           &lt;dbl&gt;            &lt;int&gt;</span></span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a><span class="co">#&gt;  1   -988.       0.0333 $100 Gain       0.957                1</span></span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a><span class="co">#&gt;  2   -988.       0.25   $100 Gain       0.862                2</span></span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a><span class="co">#&gt;  3   -988.       0.5    $100 Gain       0.771                3</span></span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a><span class="co">#&gt;  4   -988.       1      $100 Gain       0.750                4</span></span>
<span id="cb15-14"><a href="#cb15-14" tabindex="-1"></a><span class="co">#&gt;  5   -988.       6      $100 Gain       0.456                5</span></span>
<span id="cb15-15"><a href="#cb15-15" tabindex="-1"></a><span class="co">#&gt;  6   -988.      60      $100 Gain       0.200                6</span></span>
<span id="cb15-16"><a href="#cb15-16" tabindex="-1"></a><span class="co">#&gt;  7   -988.       0.0333 alcohol         0.569                1</span></span>
<span id="cb15-17"><a href="#cb15-17" tabindex="-1"></a><span class="co">#&gt;  8   -988.       0.25   alcohol         0.273                2</span></span>
<span id="cb15-18"><a href="#cb15-18" tabindex="-1"></a><span class="co">#&gt;  9   -988.       0.5    alcohol         0.329                3</span></span>
<span id="cb15-19"><a href="#cb15-19" tabindex="-1"></a><span class="co">#&gt; 10   -988.       1      alcohol         0.189                4</span></span>
<span id="cb15-20"><a href="#cb15-20" tabindex="-1"></a><span class="co">#&gt; # ℹ 350 more rows</span></span></code></pre></div>
<p>The ordinals will be added as a new variable in the data set. The
name of the variable will be the name of the original probability
variable (“delay_months” in this case) with “_ord” added afterwards. For
the <code>examp_DD</code> data set, the odds against will be included as
<code>delay_months_ord</code>.</p>
<p>If ordinal values are desired for probability discounting data, then
the <code>prob_disc = TRUE</code> flag must be set. For probability
discounting, the ordinal values will be calculated in reverse order to
match taking ordinal values of the odds against receiving the outcome.
In other words, for delay discounting ordinal position of a delay
<strong>increases</strong> as delay <strong>increases</strong> but for
probability typically we want ordinal value <strong>increasing</strong>
as the probability <strong>decreases</strong>.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a><span class="fu">prep_ordinal</span>(<span class="at">dat =</span> examp_PD,</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>             <span class="at">x_axis =</span> <span class="st">&quot;prob&quot;</span>,</span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>             <span class="at">groupings =</span> <span class="fu">c</span>(<span class="st">&quot;subject&quot;</span>,<span class="st">&quot;outcome&quot;</span>),</span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>             <span class="at">prob_disc =</span> <span class="cn">TRUE</span>)</span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a><span class="co">#&gt; # A tibble: 360 × 5</span></span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a><span class="co">#&gt; # Groups:   subject, outcome [60]</span></span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a><span class="co">#&gt;    subject  prob outcome   prop_indiff prob_ord</span></span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a><span class="co">#&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;           &lt;dbl&gt;    &lt;int&gt;</span></span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a><span class="co">#&gt;  1   -988.  0.95 $100 Gain       0.957        1</span></span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a><span class="co">#&gt;  2   -988.  0.9  $100 Gain       0.862        2</span></span>
<span id="cb16-12"><a href="#cb16-12" tabindex="-1"></a><span class="co">#&gt;  3   -988.  0.7  $100 Gain       0.771        3</span></span>
<span id="cb16-13"><a href="#cb16-13" tabindex="-1"></a><span class="co">#&gt;  4   -988.  0.5  $100 Gain       0.750        4</span></span>
<span id="cb16-14"><a href="#cb16-14" tabindex="-1"></a><span class="co">#&gt;  5   -988.  0.3  $100 Gain       0.456        5</span></span>
<span id="cb16-15"><a href="#cb16-15" tabindex="-1"></a><span class="co">#&gt;  6   -988.  0.05 $100 Gain       0.200        6</span></span>
<span id="cb16-16"><a href="#cb16-16" tabindex="-1"></a><span class="co">#&gt;  7   -988.  0.95 alcohol         0.569        1</span></span>
<span id="cb16-17"><a href="#cb16-17" tabindex="-1"></a><span class="co">#&gt;  8   -988.  0.9  alcohol         0.273        2</span></span>
<span id="cb16-18"><a href="#cb16-18" tabindex="-1"></a><span class="co">#&gt;  9   -988.  0.7  alcohol         0.329        3</span></span>
<span id="cb16-19"><a href="#cb16-19" tabindex="-1"></a><span class="co">#&gt; 10   -988.  0.5  alcohol         0.189        4</span></span>
<span id="cb16-20"><a href="#cb16-20" tabindex="-1"></a><span class="co">#&gt; # ℹ 350 more rows</span></span></code></pre></div>
</div>
<div id="prep_ordinals_all" class="section level2">
<h2>prep_ordinals_all()</h2>
<p><code>prep_ordinal_all()</code> is currently included to account for
situations in which participants experience different x_axis values. For
example, indifference points might be obtained for participant 1 at 1
week, 1 month, and 6 months and for participant 2 at 1 week, 3 months,
and 1 year. In such a case, it would not be appropriate to label the
ordinals as 1, 2, and 3 for the respective subjects. <a href="https://doi.org/10.1016/j.beproc.2015.09.009">Young (2016)</a> has
proposed using a Halton sequence to measure discounting, but to my
knowledge this technique has not be used. In a Halton sequence, a vast
number of x_axis values would be used to provide a more accurate picture
of the global discounting curve.</p>
<p>To account for this sort of situation, the
<code>prep_ordinal_all()</code> function calculates the ordinal value
for each x_axis value based on the respective ordinal position in the
list of all x_axis values not just the ordinal position of values for a
specific subject.</p>
<p>As there is currently limited utility for this technique, an example
data set is not included in the package and must be created</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a><span class="co">#Create data based on values included in above example</span></span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>examp_ord_all <span class="ot">=</span> </span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>    <span class="at">sub =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>),</span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a>    <span class="at">delay_weeks =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">26</span>, <span class="dv">1</span>, <span class="dv">13</span>, <span class="dv">52</span>)</span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a>    )</span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a></span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a><span class="co">#Groupings are not necessary</span></span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a><span class="fu">prep_ordinal_all</span>(<span class="at">dat =</span> examp_ord_all,</span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a>                 <span class="at">x_axis =</span> <span class="st">&quot;delay_weeks&quot;</span>)</span>
<span id="cb17-12"><a href="#cb17-12" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 3</span></span>
<span id="cb17-13"><a href="#cb17-13" tabindex="-1"></a><span class="co">#&gt;     sub delay_weeks delay_weeks_ord</span></span>
<span id="cb17-14"><a href="#cb17-14" tabindex="-1"></a><span class="co">#&gt;   &lt;dbl&gt;       &lt;dbl&gt;           &lt;int&gt;</span></span>
<span id="cb17-15"><a href="#cb17-15" tabindex="-1"></a><span class="co">#&gt; 1     1           1               1</span></span>
<span id="cb17-16"><a href="#cb17-16" tabindex="-1"></a><span class="co">#&gt; 2     1           4               2</span></span>
<span id="cb17-17"><a href="#cb17-17" tabindex="-1"></a><span class="co">#&gt; 3     1          26               4</span></span>
<span id="cb17-18"><a href="#cb17-18" tabindex="-1"></a><span class="co">#&gt; 4     2           1               1</span></span>
<span id="cb17-19"><a href="#cb17-19" tabindex="-1"></a><span class="co">#&gt; 5     2          13               3</span></span>
<span id="cb17-20"><a href="#cb17-20" tabindex="-1"></a><span class="co">#&gt; 6     2          52               5</span></span></code></pre></div>
<p>As with <code>prep_ordinal()</code>, if the data are from probability
discounting then <code>prep_ordinal_all()</code> will reverse order the
ordinal values.</p>
</div>
<div id="prep_log" class="section level2">
<h2>prep_log()</h2>
<div id="accounting-for-log0" class="section level3">
<h3>Accounting for log(0)</h3>
<p>When log transforming any values, a common concern is how to account
for <code>log(0)</code> which is undefined.</p>
<div id="adding-a-correction-factor" class="section level4">
<h4>Adding a correction factor</h4>
<p>A common recommendation is to add a constant value (e.g., 1) to all
values in the data set and transform the “corrected” values. One
limitation of just using correction factor can change the relative
distances between the log transformed <code>x_axis</code> values (those
relative distances being the whole point of the log transformation in
the first place).</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a></span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a><span class="fu">prep_log_AUC</span>(<span class="at">dat =</span> examp_DD,</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>             <span class="at">x_axis =</span> <span class="st">&quot;delay_months&quot;</span>,</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>             <span class="at">type =</span> <span class="st">&quot;corr&quot;</span>)</span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a><span class="co">#&gt; # A tibble: 360 × 5</span></span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a><span class="co">#&gt;    subject delay_months outcome       prop_indiff log_delay_months</span></span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a><span class="co">#&gt;      &lt;dbl&gt;        &lt;dbl&gt; &lt;chr&gt;               &lt;dbl&gt;            &lt;dbl&gt;</span></span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a><span class="co">#&gt;  1     103       0.0333 alcohol             0.878           0.0473</span></span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a><span class="co">#&gt;  2     103       0.25   alcohol             0.749           0.322 </span></span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a><span class="co">#&gt;  3     103       0.5    alcohol             0.747           0.585 </span></span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a><span class="co">#&gt;  4     103       1      alcohol             0.741           1     </span></span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a><span class="co">#&gt;  5     103       6      alcohol             0.249           2.81  </span></span>
<span id="cb18-13"><a href="#cb18-13" tabindex="-1"></a><span class="co">#&gt;  6     103      60      alcohol             0.241           5.93  </span></span>
<span id="cb18-14"><a href="#cb18-14" tabindex="-1"></a><span class="co">#&gt;  7     103       0.0333 entertainment       0.987           0.0473</span></span>
<span id="cb18-15"><a href="#cb18-15" tabindex="-1"></a><span class="co">#&gt;  8     103       0.25   entertainment       0.933           0.322 </span></span>
<span id="cb18-16"><a href="#cb18-16" tabindex="-1"></a><span class="co">#&gt;  9     103       0.5    entertainment       0.929           0.585 </span></span>
<span id="cb18-17"><a href="#cb18-17" tabindex="-1"></a><span class="co">#&gt; 10     103       1      entertainment       0.935           1     </span></span>
<span id="cb18-18"><a href="#cb18-18" tabindex="-1"></a><span class="co">#&gt; # ℹ 350 more rows</span></span></code></pre></div>
<p>The correction factor can be specified by setting
<code>correction</code> to the desired value.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a></span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a><span class="fu">prep_log_AUC</span>(<span class="at">dat =</span> examp_DD,</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>             <span class="at">x_axis =</span> <span class="st">&quot;delay_months&quot;</span>,</span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a>             <span class="at">type =</span> <span class="st">&quot;corr&quot;</span>,</span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a>             <span class="at">correction =</span> .<span class="dv">25</span>)</span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a><span class="co">#&gt; # A tibble: 360 × 5</span></span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a><span class="co">#&gt;    subject delay_months outcome       prop_indiff log_delay_months</span></span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a><span class="co">#&gt;      &lt;dbl&gt;        &lt;dbl&gt; &lt;chr&gt;               &lt;dbl&gt;            &lt;dbl&gt;</span></span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a><span class="co">#&gt;  1     103       0.0333 alcohol             0.878           -1.82 </span></span>
<span id="cb19-10"><a href="#cb19-10" tabindex="-1"></a><span class="co">#&gt;  2     103       0.25   alcohol             0.749           -1    </span></span>
<span id="cb19-11"><a href="#cb19-11" tabindex="-1"></a><span class="co">#&gt;  3     103       0.5    alcohol             0.747           -0.415</span></span>
<span id="cb19-12"><a href="#cb19-12" tabindex="-1"></a><span class="co">#&gt;  4     103       1      alcohol             0.741            0.322</span></span>
<span id="cb19-13"><a href="#cb19-13" tabindex="-1"></a><span class="co">#&gt;  5     103       6      alcohol             0.249            2.64 </span></span>
<span id="cb19-14"><a href="#cb19-14" tabindex="-1"></a><span class="co">#&gt;  6     103      60      alcohol             0.241            5.91 </span></span>
<span id="cb19-15"><a href="#cb19-15" tabindex="-1"></a><span class="co">#&gt;  7     103       0.0333 entertainment       0.987           -1.82 </span></span>
<span id="cb19-16"><a href="#cb19-16" tabindex="-1"></a><span class="co">#&gt;  8     103       0.25   entertainment       0.933           -1    </span></span>
<span id="cb19-17"><a href="#cb19-17" tabindex="-1"></a><span class="co">#&gt;  9     103       0.5    entertainment       0.929           -0.415</span></span>
<span id="cb19-18"><a href="#cb19-18" tabindex="-1"></a><span class="co">#&gt; 10     103       1      entertainment       0.935            0.322</span></span>
<span id="cb19-19"><a href="#cb19-19" tabindex="-1"></a><span class="co">#&gt; # ℹ 350 more rows</span></span></code></pre></div>
<p>An additional problem that will crop up when calculating log
transformed x_axis values is that you will have negative log(X) values,
which is problematic for the standard method for calculating AUC. The
following method for correcting log transformed x_axis values accounts
for the negative log(X) values.</p>
</div>
<div id="adjusting-log-transformed-values" class="section level4">
<h4>Adjusting log transformed values</h4>
<p>Included in this package is a method for correcting log(0) values
that is referred to as “adjust.” The adjust method calculates the mean
distance between each successive log transformed x_axis value, forces
log(0) = 0, and then add the mean log distance to the log transformed
indifference points. Essentially, the adjust procedure uses a correction
factor that will shift the indifference points upwards without changing
the underlying distribution of the data. Specifically,</p>
<p><span class="math display">\[
\kappa = \frac{\sum_{n=1}^{N-1} (\log(X_{n+1}) - \log(X_{n}))}{N}
\]</span></p>
<p>and</p>
<p><span class="math display">\[
X_{logtrans} = \log(X_{old}) + \kappa
\]</span></p>
<p>The following code block demonstrates the calculations for adjustment
correction.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a></span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a><span class="co">#Initial vector with delays (in weeks)</span></span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>delays <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.25</span>, <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">26</span>)</span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a><span class="co">#Log transform delays</span></span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a>log_delays <span class="ot">=</span> <span class="fu">log</span>(delays, <span class="at">base =</span> <span class="dv">2</span>)</span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a></span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a><span class="co">#Display values</span></span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a>log_delays</span>
<span id="cb20-10"><a href="#cb20-10" tabindex="-1"></a><span class="co">#&gt; [1]     -Inf -2.00000  0.00000  2.00000  4.70044</span></span>
<span id="cb20-11"><a href="#cb20-11" tabindex="-1"></a></span>
<span id="cb20-12"><a href="#cb20-12" tabindex="-1"></a><span class="co">#Eliminate log(0) = -Inf</span></span>
<span id="cb20-13"><a href="#cb20-13" tabindex="-1"></a>non_zero_log <span class="ot">=</span> log_delays[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb20-14"><a href="#cb20-14" tabindex="-1"></a></span>
<span id="cb20-15"><a href="#cb20-15" tabindex="-1"></a><span class="co">#Calculate the difference between succesive non-zero indifference points</span></span>
<span id="cb20-16"><a href="#cb20-16" tabindex="-1"></a>log_diff <span class="ot">=</span> <span class="fu">diff</span>(non_zero_log)</span>
<span id="cb20-17"><a href="#cb20-17" tabindex="-1"></a></span>
<span id="cb20-18"><a href="#cb20-18" tabindex="-1"></a><span class="co">#Print log_diff</span></span>
<span id="cb20-19"><a href="#cb20-19" tabindex="-1"></a>log_diff</span>
<span id="cb20-20"><a href="#cb20-20" tabindex="-1"></a><span class="co">#&gt; [1] 2.00000 2.00000 2.70044</span></span>
<span id="cb20-21"><a href="#cb20-21" tabindex="-1"></a></span>
<span id="cb20-22"><a href="#cb20-22" tabindex="-1"></a><span class="co">#Adjustment factor</span></span>
<span id="cb20-23"><a href="#cb20-23" tabindex="-1"></a>adjustment <span class="ot">=</span> <span class="fu">mean</span>(log_diff)</span>
<span id="cb20-24"><a href="#cb20-24" tabindex="-1"></a></span>
<span id="cb20-25"><a href="#cb20-25" tabindex="-1"></a><span class="co">#Adjust log delays</span></span>
<span id="cb20-26"><a href="#cb20-26" tabindex="-1"></a>new_log_delays <span class="ot">=</span> log_delays <span class="sc">+</span> adjustment</span>
<span id="cb20-27"><a href="#cb20-27" tabindex="-1"></a></span>
<span id="cb20-28"><a href="#cb20-28" tabindex="-1"></a><span class="co">#Set log(0) = 0</span></span>
<span id="cb20-29"><a href="#cb20-29" tabindex="-1"></a>new_log_delays[<span class="dv">1</span>] <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb20-30"><a href="#cb20-30" tabindex="-1"></a></span>
<span id="cb20-31"><a href="#cb20-31" tabindex="-1"></a><span class="co">#Print adjusted log delays</span></span>
<span id="cb20-32"><a href="#cb20-32" tabindex="-1"></a>new_log_delays</span>
<span id="cb20-33"><a href="#cb20-33" tabindex="-1"></a><span class="co">#&gt; [1] 0.0000000 0.2334799 2.2334799 4.2334799 6.9339196</span></span></code></pre></div>
<p>Additionally, the adjust method includes an automated correction for
x_axis values that are between 0 and 1. The AUC formula assumes that the
lowest x_axis value is 0. However, if an x_axis value is between 0 and 1
(for example 1 week will be expressed as 0.25 if the delays are
expressed as months) then the log transformed x_axis value will be
negative. The negative x_axis values will introduce errors to the AUC
calculations. One solution is to express all indifference points in the
lowest possible unit (weeks instead of months, days instead of weeks,
etc.). The solution this package uses is to increase all of the log
transformed x_axis values by the absolute value of the minimum log
transformed x_axis value. Specifically,</p>
<p><span class="math display">\[
X_{logtrans} = \log(X_{old}) + \log(\min(X))
\]</span></p>
<p>is the formula for correcting for negative log transformed x_axis
values.</p>
<p>In total, the final logs transformed X values can be found with the
formula,</p>
<p><span class="math display">\[
X_{logtrans} = \log(X_{old}) + \kappa + \log(\min(X))
\]</span></p>
<p>This adjustment procedure is the default method the AUC function uses
is an “adjustment” to all of the log transformed values.</p>
<p>The following code block gives an example of the
<code>&quot;adjust&quot;</code> method for log AUC.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a></span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a><span class="co">#Default adjust method</span></span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a><span class="fu">prep_log_AUC</span>(<span class="at">dat =</span> examp_DD,</span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a>             <span class="at">x_axis =</span> <span class="st">&quot;delay_months&quot;</span>,</span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a>             <span class="at">type =</span> <span class="st">&quot;adjust&quot;</span>)</span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a><span class="co">#&gt; # A tibble: 360 × 5</span></span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a><span class="co">#&gt;    subject delay_months outcome       prop_indiff log_delay_months</span></span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a><span class="co">#&gt;      &lt;dbl&gt;        &lt;dbl&gt; &lt;chr&gt;               &lt;dbl&gt;            &lt;dbl&gt;</span></span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a><span class="co">#&gt;  1     103       0.0333 alcohol             0.878             0   </span></span>
<span id="cb21-10"><a href="#cb21-10" tabindex="-1"></a><span class="co">#&gt;  2     103       0.25   alcohol             0.749             2.91</span></span>
<span id="cb21-11"><a href="#cb21-11" tabindex="-1"></a><span class="co">#&gt;  3     103       0.5    alcohol             0.747             3.91</span></span>
<span id="cb21-12"><a href="#cb21-12" tabindex="-1"></a><span class="co">#&gt;  4     103       1      alcohol             0.741             4.91</span></span>
<span id="cb21-13"><a href="#cb21-13" tabindex="-1"></a><span class="co">#&gt;  5     103       6      alcohol             0.249             7.49</span></span>
<span id="cb21-14"><a href="#cb21-14" tabindex="-1"></a><span class="co">#&gt;  6     103      60      alcohol             0.241            10.8 </span></span>
<span id="cb21-15"><a href="#cb21-15" tabindex="-1"></a><span class="co">#&gt;  7     103       0.0333 entertainment       0.987             0   </span></span>
<span id="cb21-16"><a href="#cb21-16" tabindex="-1"></a><span class="co">#&gt;  8     103       0.25   entertainment       0.933             2.91</span></span>
<span id="cb21-17"><a href="#cb21-17" tabindex="-1"></a><span class="co">#&gt;  9     103       0.5    entertainment       0.929             3.91</span></span>
<span id="cb21-18"><a href="#cb21-18" tabindex="-1"></a><span class="co">#&gt; 10     103       1      entertainment       0.935             4.91</span></span>
<span id="cb21-19"><a href="#cb21-19" tabindex="-1"></a><span class="co">#&gt; # ℹ 350 more rows</span></span></code></pre></div>
<p>If the adjust method is still desired with out the decimal
correction, set <code>dec_offset = FALSE</code>.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a></span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a><span class="co">#Log adjust method with no decimal correction</span></span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a><span class="fu">prep_log_AUC</span>(<span class="at">dat =</span> examp_DD,</span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a>             <span class="at">x_axis =</span> <span class="st">&quot;delay_months&quot;</span>,</span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a>             <span class="at">type =</span> <span class="st">&quot;adjust&quot;</span>,</span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a>             <span class="at">dec_offset =</span> <span class="cn">FALSE</span>)</span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a><span class="co">#&gt; # A tibble: 360 × 5</span></span>
<span id="cb22-8"><a href="#cb22-8" tabindex="-1"></a><span class="co">#&gt;    subject delay_months outcome       prop_indiff log_delay_months</span></span>
<span id="cb22-9"><a href="#cb22-9" tabindex="-1"></a><span class="co">#&gt;      &lt;dbl&gt;        &lt;dbl&gt; &lt;chr&gt;               &lt;dbl&gt;            &lt;dbl&gt;</span></span>
<span id="cb22-10"><a href="#cb22-10" tabindex="-1"></a><span class="co">#&gt;  1     103       0.0333 alcohol             0.878            -4.91</span></span>
<span id="cb22-11"><a href="#cb22-11" tabindex="-1"></a><span class="co">#&gt;  2     103       0.25   alcohol             0.749            -2   </span></span>
<span id="cb22-12"><a href="#cb22-12" tabindex="-1"></a><span class="co">#&gt;  3     103       0.5    alcohol             0.747            -1   </span></span>
<span id="cb22-13"><a href="#cb22-13" tabindex="-1"></a><span class="co">#&gt;  4     103       1      alcohol             0.741             0   </span></span>
<span id="cb22-14"><a href="#cb22-14" tabindex="-1"></a><span class="co">#&gt;  5     103       6      alcohol             0.249             2.58</span></span>
<span id="cb22-15"><a href="#cb22-15" tabindex="-1"></a><span class="co">#&gt;  6     103      60      alcohol             0.241             5.91</span></span>
<span id="cb22-16"><a href="#cb22-16" tabindex="-1"></a><span class="co">#&gt;  7     103       0.0333 entertainment       0.987            -4.91</span></span>
<span id="cb22-17"><a href="#cb22-17" tabindex="-1"></a><span class="co">#&gt;  8     103       0.25   entertainment       0.933            -2   </span></span>
<span id="cb22-18"><a href="#cb22-18" tabindex="-1"></a><span class="co">#&gt;  9     103       0.5    entertainment       0.929            -1   </span></span>
<span id="cb22-19"><a href="#cb22-19" tabindex="-1"></a><span class="co">#&gt; 10     103       1      entertainment       0.935             0   </span></span>
<span id="cb22-20"><a href="#cb22-20" tabindex="-1"></a><span class="co">#&gt; # ℹ 350 more rows</span></span></code></pre></div>
</div>
<div id="inverse-hyperbolic-sine-transformation-ihs" class="section level4">
<h4>Inverse Hyperbolic Sine Transformation (IHS)</h4>
<p>The final method for log transformation is not strictly a log
transformation. <a href="https://doi.org/10.1002/jeab.679">Gilroy et
al. (2021)</a> proposed using the IHS transformation to aid in conduct
demand analyses. Specifically, IHS was proposed to handle consumption
values obtained from hypothetical purchase tasks and the associated
problems of log transforming zero consumption values. I highly recommend
reading their description of the IHS transformation. The first main
benefit of the IHS transformation is that <span class="math inline">\(\mathrm{IHS}(0) = 0\)</span>. The second benefit
of IHS is that it produces values that are generally similar to log
transformed values (i.e., a high degree of correlation).</p>
<p>Specifically,</p>
<p><span class="math display">\[
\mathrm{IHS}(X) = \sinh^{-1}{ X} = \mathrm{arsinh } (X)
\]</span></p>
<p>and the specific calculations for a single value are</p>
<p><span class="math display">\[
\mathrm{IHS}(X) = \ln{(X + \sqrt{X^2 + 1})}
\]</span></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a></span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a><span class="co">#IHS transformation</span></span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a><span class="fu">prep_log_AUC</span>(<span class="at">dat =</span> examp_DD,</span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a>             <span class="at">x_axis =</span> <span class="st">&quot;delay_months&quot;</span>,</span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a>             <span class="at">type =</span> <span class="st">&quot;IHS&quot;</span>)</span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a><span class="co">#&gt; # A tibble: 360 × 5</span></span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a><span class="co">#&gt;    subject delay_months outcome       prop_indiff log_delay_months</span></span>
<span id="cb23-8"><a href="#cb23-8" tabindex="-1"></a><span class="co">#&gt;      &lt;dbl&gt;        &lt;dbl&gt; &lt;chr&gt;               &lt;dbl&gt;            &lt;dbl&gt;</span></span>
<span id="cb23-9"><a href="#cb23-9" tabindex="-1"></a><span class="co">#&gt;  1     103       0.0333 alcohol             0.878           0.0333</span></span>
<span id="cb23-10"><a href="#cb23-10" tabindex="-1"></a><span class="co">#&gt;  2     103       0.25   alcohol             0.749           0.247 </span></span>
<span id="cb23-11"><a href="#cb23-11" tabindex="-1"></a><span class="co">#&gt;  3     103       0.5    alcohol             0.747           0.481 </span></span>
<span id="cb23-12"><a href="#cb23-12" tabindex="-1"></a><span class="co">#&gt;  4     103       1      alcohol             0.741           0.881 </span></span>
<span id="cb23-13"><a href="#cb23-13" tabindex="-1"></a><span class="co">#&gt;  5     103       6      alcohol             0.249           2.49  </span></span>
<span id="cb23-14"><a href="#cb23-14" tabindex="-1"></a><span class="co">#&gt;  6     103      60      alcohol             0.241           4.79  </span></span>
<span id="cb23-15"><a href="#cb23-15" tabindex="-1"></a><span class="co">#&gt;  7     103       0.0333 entertainment       0.987           0.0333</span></span>
<span id="cb23-16"><a href="#cb23-16" tabindex="-1"></a><span class="co">#&gt;  8     103       0.25   entertainment       0.933           0.247 </span></span>
<span id="cb23-17"><a href="#cb23-17" tabindex="-1"></a><span class="co">#&gt;  9     103       0.5    entertainment       0.929           0.481 </span></span>
<span id="cb23-18"><a href="#cb23-18" tabindex="-1"></a><span class="co">#&gt; 10     103       1      entertainment       0.935           0.881 </span></span>
<span id="cb23-19"><a href="#cb23-19" tabindex="-1"></a><span class="co">#&gt; # ℹ 350 more rows</span></span></code></pre></div>
</div>
</div>
</div>
</div>
<div id="combining-finer-control-functions" class="section level1">
<h1>Combining Finer Control Functions</h1>
<p>The functions described above can be used in a successive fashion.
For example, when obtaining AUClog for probability discounting: first,
probabilities of receiving an outcome should be converted to odds
against and then second, log transformations should be performed on odds
against values.</p>
<p>The main factor to account for when feeding the results from one
function to the next function is that the <code>x_axis</code> value of
interest changes after transformations have been transformed. Following
the above example, we transform probability values into odds against
values. For the log transformation, we want to treat the odds against
values as the x_axis of interest.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a></span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a><span class="co">#Calculate odds against</span></span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a>examp_PD_odds <span class="ot">=</span> <span class="fu">prep_odds_against</span>(<span class="at">dat =</span> examp_PD,</span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a>                  <span class="at">x_axis =</span> <span class="st">&quot;prob&quot;</span>,</span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a>                  <span class="at">groupings =</span> <span class="fu">c</span>(<span class="st">&quot;subject&quot;</span>,<span class="st">&quot;outcome&quot;</span>))</span>
<span id="cb24-6"><a href="#cb24-6" tabindex="-1"></a></span>
<span id="cb24-7"><a href="#cb24-7" tabindex="-1"></a><span class="co">#Print odds against</span></span>
<span id="cb24-8"><a href="#cb24-8" tabindex="-1"></a>examp_PD_odds</span>
<span id="cb24-9"><a href="#cb24-9" tabindex="-1"></a><span class="co">#&gt; # A tibble: 360 × 5</span></span>
<span id="cb24-10"><a href="#cb24-10" tabindex="-1"></a><span class="co">#&gt; # Groups:   subject, outcome [60]</span></span>
<span id="cb24-11"><a href="#cb24-11" tabindex="-1"></a><span class="co">#&gt;    subject  prob outcome   prop_indiff prob_against</span></span>
<span id="cb24-12"><a href="#cb24-12" tabindex="-1"></a><span class="co">#&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;           &lt;dbl&gt;        &lt;dbl&gt;</span></span>
<span id="cb24-13"><a href="#cb24-13" tabindex="-1"></a><span class="co">#&gt;  1   -988.  0.95 $100 Gain       0.957       0.0526</span></span>
<span id="cb24-14"><a href="#cb24-14" tabindex="-1"></a><span class="co">#&gt;  2   -988.  0.9  $100 Gain       0.862       0.111 </span></span>
<span id="cb24-15"><a href="#cb24-15" tabindex="-1"></a><span class="co">#&gt;  3   -988.  0.7  $100 Gain       0.771       0.429 </span></span>
<span id="cb24-16"><a href="#cb24-16" tabindex="-1"></a><span class="co">#&gt;  4   -988.  0.5  $100 Gain       0.750       1     </span></span>
<span id="cb24-17"><a href="#cb24-17" tabindex="-1"></a><span class="co">#&gt;  5   -988.  0.3  $100 Gain       0.456       2.33  </span></span>
<span id="cb24-18"><a href="#cb24-18" tabindex="-1"></a><span class="co">#&gt;  6   -988.  0.05 $100 Gain       0.200      19     </span></span>
<span id="cb24-19"><a href="#cb24-19" tabindex="-1"></a><span class="co">#&gt;  7   -988.  0.95 alcohol         0.569       0.0526</span></span>
<span id="cb24-20"><a href="#cb24-20" tabindex="-1"></a><span class="co">#&gt;  8   -988.  0.9  alcohol         0.273       0.111 </span></span>
<span id="cb24-21"><a href="#cb24-21" tabindex="-1"></a><span class="co">#&gt;  9   -988.  0.7  alcohol         0.329       0.429 </span></span>
<span id="cb24-22"><a href="#cb24-22" tabindex="-1"></a><span class="co">#&gt; 10   -988.  0.5  alcohol         0.189       1     </span></span>
<span id="cb24-23"><a href="#cb24-23" tabindex="-1"></a><span class="co">#&gt; # ℹ 350 more rows</span></span>
<span id="cb24-24"><a href="#cb24-24" tabindex="-1"></a></span>
<span id="cb24-25"><a href="#cb24-25" tabindex="-1"></a><span class="co">#Add zeros, but already converted to odds against so prob_disc = FALSE</span></span>
<span id="cb24-26"><a href="#cb24-26" tabindex="-1"></a><span class="co">#Note the x_axis value was changed to &quot;prob_against&quot; which was the newly added column</span></span>
<span id="cb24-27"><a href="#cb24-27" tabindex="-1"></a>examp_PD_odds <span class="ot">=</span> <span class="fu">AUC_zeros</span>(<span class="at">dat =</span> examp_PD_odds,</span>
<span id="cb24-28"><a href="#cb24-28" tabindex="-1"></a>          <span class="at">x_axis =</span> <span class="st">&quot;prob_against&quot;</span>,</span>
<span id="cb24-29"><a href="#cb24-29" tabindex="-1"></a>          <span class="at">indiff =</span> <span class="st">&quot;prop_indiff&quot;</span>,</span>
<span id="cb24-30"><a href="#cb24-30" tabindex="-1"></a>          <span class="at">amount =</span> <span class="dv">1</span>,</span>
<span id="cb24-31"><a href="#cb24-31" tabindex="-1"></a>          <span class="at">groupings =</span> <span class="fu">c</span>(<span class="st">&quot;subject&quot;</span>,<span class="st">&quot;outcome&quot;</span>),</span>
<span id="cb24-32"><a href="#cb24-32" tabindex="-1"></a>          <span class="at">prob_disc =</span> <span class="cn">FALSE</span>)</span>
<span id="cb24-33"><a href="#cb24-33" tabindex="-1"></a></span>
<span id="cb24-34"><a href="#cb24-34" tabindex="-1"></a><span class="co">#Print odds agianst with zeros</span></span>
<span id="cb24-35"><a href="#cb24-35" tabindex="-1"></a>examp_PD_odds</span>
<span id="cb24-36"><a href="#cb24-36" tabindex="-1"></a><span class="co">#&gt; # A tibble: 420 × 6</span></span>
<span id="cb24-37"><a href="#cb24-37" tabindex="-1"></a><span class="co">#&gt;    subject outcome   prob_against prop_indiff orig   prob</span></span>
<span id="cb24-38"><a href="#cb24-38" tabindex="-1"></a><span class="co">#&gt;      &lt;dbl&gt; &lt;chr&gt;            &lt;dbl&gt;       &lt;dbl&gt; &lt;lgl&gt; &lt;dbl&gt;</span></span>
<span id="cb24-39"><a href="#cb24-39" tabindex="-1"></a><span class="co">#&gt;  1   -988. $100 Gain       0            1     FALSE NA   </span></span>
<span id="cb24-40"><a href="#cb24-40" tabindex="-1"></a><span class="co">#&gt;  2   -988. $100 Gain       0.0526       0.957 TRUE   0.95</span></span>
<span id="cb24-41"><a href="#cb24-41" tabindex="-1"></a><span class="co">#&gt;  3   -988. $100 Gain       0.111        0.862 TRUE   0.9 </span></span>
<span id="cb24-42"><a href="#cb24-42" tabindex="-1"></a><span class="co">#&gt;  4   -988. $100 Gain       0.429        0.771 TRUE   0.7 </span></span>
<span id="cb24-43"><a href="#cb24-43" tabindex="-1"></a><span class="co">#&gt;  5   -988. $100 Gain       1            0.750 TRUE   0.5 </span></span>
<span id="cb24-44"><a href="#cb24-44" tabindex="-1"></a><span class="co">#&gt;  6   -988. $100 Gain       2.33         0.456 TRUE   0.3 </span></span>
<span id="cb24-45"><a href="#cb24-45" tabindex="-1"></a><span class="co">#&gt;  7   -988. $100 Gain      19            0.200 TRUE   0.05</span></span>
<span id="cb24-46"><a href="#cb24-46" tabindex="-1"></a><span class="co">#&gt;  8   -988. alcohol         0            1     FALSE NA   </span></span>
<span id="cb24-47"><a href="#cb24-47" tabindex="-1"></a><span class="co">#&gt;  9   -988. alcohol         0.0526       0.569 TRUE   0.95</span></span>
<span id="cb24-48"><a href="#cb24-48" tabindex="-1"></a><span class="co">#&gt; 10   -988. alcohol         0.111        0.273 TRUE   0.9 </span></span>
<span id="cb24-49"><a href="#cb24-49" tabindex="-1"></a><span class="co">#&gt; # ℹ 410 more rows</span></span>
<span id="cb24-50"><a href="#cb24-50" tabindex="-1"></a></span>
<span id="cb24-51"><a href="#cb24-51" tabindex="-1"></a><span class="co">#Odds against to log_odds against.</span></span>
<span id="cb24-52"><a href="#cb24-52" tabindex="-1"></a><span class="co">#Note the x_axis value was changed to &quot;prob_against&quot; which was the newly added column</span></span>
<span id="cb24-53"><a href="#cb24-53" tabindex="-1"></a>examp_PD_log_odds <span class="ot">=</span> <span class="fu">prep_log_AUC</span>(<span class="at">dat =</span> examp_PD_odds,</span>
<span id="cb24-54"><a href="#cb24-54" tabindex="-1"></a>                                 <span class="at">x_axis =</span> <span class="st">&quot;prob_against&quot;</span>,</span>
<span id="cb24-55"><a href="#cb24-55" tabindex="-1"></a>                                 <span class="at">type =</span> <span class="st">&quot;adjust&quot;</span>)</span>
<span id="cb24-56"><a href="#cb24-56" tabindex="-1"></a></span>
<span id="cb24-57"><a href="#cb24-57" tabindex="-1"></a>examp_PD_log_odds</span>
<span id="cb24-58"><a href="#cb24-58" tabindex="-1"></a><span class="co">#&gt; # A tibble: 420 × 7</span></span>
<span id="cb24-59"><a href="#cb24-59" tabindex="-1"></a><span class="co">#&gt;    subject outcome   prob_against prop_indiff orig   prob log_prob_against</span></span>
<span id="cb24-60"><a href="#cb24-60" tabindex="-1"></a><span class="co">#&gt;      &lt;dbl&gt; &lt;chr&gt;            &lt;dbl&gt;       &lt;dbl&gt; &lt;lgl&gt; &lt;dbl&gt;            &lt;dbl&gt;</span></span>
<span id="cb24-61"><a href="#cb24-61" tabindex="-1"></a><span class="co">#&gt;  1   -988. $100 Gain       0            1     FALSE NA                0   </span></span>
<span id="cb24-62"><a href="#cb24-62" tabindex="-1"></a><span class="co">#&gt;  2   -988. $100 Gain       0.0526       0.957 TRUE   0.95             1.70</span></span>
<span id="cb24-63"><a href="#cb24-63" tabindex="-1"></a><span class="co">#&gt;  3   -988. $100 Gain       0.111        0.862 TRUE   0.9              2.78</span></span>
<span id="cb24-64"><a href="#cb24-64" tabindex="-1"></a><span class="co">#&gt;  4   -988. $100 Gain       0.429        0.771 TRUE   0.7              4.72</span></span>
<span id="cb24-65"><a href="#cb24-65" tabindex="-1"></a><span class="co">#&gt;  5   -988. $100 Gain       1            0.750 TRUE   0.5              5.95</span></span>
<span id="cb24-66"><a href="#cb24-66" tabindex="-1"></a><span class="co">#&gt;  6   -988. $100 Gain       2.33         0.456 TRUE   0.3              7.17</span></span>
<span id="cb24-67"><a href="#cb24-67" tabindex="-1"></a><span class="co">#&gt;  7   -988. $100 Gain      19            0.200 TRUE   0.05            10.2 </span></span>
<span id="cb24-68"><a href="#cb24-68" tabindex="-1"></a><span class="co">#&gt;  8   -988. alcohol         0            1     FALSE NA                0   </span></span>
<span id="cb24-69"><a href="#cb24-69" tabindex="-1"></a><span class="co">#&gt;  9   -988. alcohol         0.0526       0.569 TRUE   0.95             1.70</span></span>
<span id="cb24-70"><a href="#cb24-70" tabindex="-1"></a><span class="co">#&gt; 10   -988. alcohol         0.111        0.273 TRUE   0.9              2.78</span></span>
<span id="cb24-71"><a href="#cb24-71" tabindex="-1"></a><span class="co">#&gt; # ℹ 410 more rows</span></span></code></pre></div>
<p>Finally, when using the completely transformed data, simply supply it
to the AUC function.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a></span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a><span class="fu">AUC</span>(<span class="at">dat =</span> examp_PD_log_odds,</span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a>    <span class="at">indiff =</span> <span class="st">&quot;prop_indiff&quot;</span>,</span>
<span id="cb25-4"><a href="#cb25-4" tabindex="-1"></a>    <span class="at">x_axis =</span> <span class="st">&quot;log_prob_against&quot;</span>,</span>
<span id="cb25-5"><a href="#cb25-5" tabindex="-1"></a>    <span class="at">amount =</span> <span class="dv">1</span>,</span>
<span id="cb25-6"><a href="#cb25-6" tabindex="-1"></a>    <span class="at">groupings =</span> <span class="fu">c</span>(<span class="st">&quot;subject&quot;</span>,<span class="st">&quot;outcome&quot;</span>))</span>
<span id="cb25-7"><a href="#cb25-7" tabindex="-1"></a><span class="co">#&gt; # A tibble: 60 × 3</span></span>
<span id="cb25-8"><a href="#cb25-8" tabindex="-1"></a><span class="co">#&gt; # Groups:   subject [15]</span></span>
<span id="cb25-9"><a href="#cb25-9" tabindex="-1"></a><span class="co">#&gt;    subject outcome          AUC</span></span>
<span id="cb25-10"><a href="#cb25-10" tabindex="-1"></a><span class="co">#&gt;      &lt;dbl&gt; &lt;chr&gt;          &lt;dbl&gt;</span></span>
<span id="cb25-11"><a href="#cb25-11" tabindex="-1"></a><span class="co">#&gt;  1   -988. $100 Gain     0.676 </span></span>
<span id="cb25-12"><a href="#cb25-12" tabindex="-1"></a><span class="co">#&gt;  2   -988. alcohol       0.309 </span></span>
<span id="cb25-13"><a href="#cb25-13" tabindex="-1"></a><span class="co">#&gt;  3   -988. entertainment 0.735 </span></span>
<span id="cb25-14"><a href="#cb25-14" tabindex="-1"></a><span class="co">#&gt;  4   -988. food          0.379 </span></span>
<span id="cb25-15"><a href="#cb25-15" tabindex="-1"></a><span class="co">#&gt;  5     -2  $100 Gain     0.0833</span></span>
<span id="cb25-16"><a href="#cb25-16" tabindex="-1"></a><span class="co">#&gt;  6     -2  alcohol       0.0833</span></span>
<span id="cb25-17"><a href="#cb25-17" tabindex="-1"></a><span class="co">#&gt;  7     -2  entertainment 0.0833</span></span>
<span id="cb25-18"><a href="#cb25-18" tabindex="-1"></a><span class="co">#&gt;  8     -2  food          0.0833</span></span>
<span id="cb25-19"><a href="#cb25-19" tabindex="-1"></a><span class="co">#&gt;  9     -1  $100 Gain     1     </span></span>
<span id="cb25-20"><a href="#cb25-20" tabindex="-1"></a><span class="co">#&gt; 10     -1  alcohol       1     </span></span>
<span id="cb25-21"><a href="#cb25-21" tabindex="-1"></a><span class="co">#&gt; # ℹ 50 more rows</span></span></code></pre></div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
